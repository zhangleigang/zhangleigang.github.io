title: 正则表达式必知必会
date: 2016-07-14 07:39:50
tags: 正则
category: 通用知识
author: 张雷刚
---

## 匹配单个字符或一组字符
  1. 我们使用元字符[和]来定义一个字符集合。
  2. 为了简化字符区间的定义，正则表达式提供了一个特殊的元字符，字符区间可以用-（连字符）来定义。
  3. 连字符只在字符集合里面起作用；其它只是被作为一个普通字符，不需要被转义。
  4. 字符集合也能进行取非匹配<!-- more -->

## 使用元字符
  元字符就是一些在正则表达式里有着特殊含义的字符。因为元字符在正则表达式里有着特殊的含义，所以这些字符就无法用来代表它们本身。
  元字符大致可以分为两种：
  * 用来匹配文本的（比如.匹配任意单个字符）
  * 正则表达式的语法所要求的（比如[和]）
  注意：对一些字符进行转义后，它们自己又代表特殊的含义了。比如\n表示换行符，\r表示回车符。

  匹配特定的字符类别：
  它是对字符集合使用的简化，常见的有数字字符集合\d，字母数字字符集合\w，空白字符集合\s
  字母数字字符集合\w等价于[a-zA-Z0-9_]
  空白字符等价于[\f\n\r\t\v]
  <table><tr><td>\f</td><td>换页</td></tr><tr><td>\n</td><td>换行</td></tr><tr><td>\r</td><td>回车</td></tr><tr><td>\t</td><td>制表符(Tab键)</td></tr><tr><td>\v</td><td>垂直制表符</td></tr></table>
  注意：\r\n是windows所使用的文本行结束标签。Linux系统只使用一个换行符\n来结束一个文本行。

## 重复次数匹配
   <table><tr><td>一次或多次重复出现</td><td>+</td></tr><tr><td>零次或多次重复出现</td><td>星号</td></tr><tr><td>零次或一次出现</td><td>?,等价与{0,1}</td></tr><tr><td>重复次数限定</td><td>{m,n},逗号的位置和有无代表含义很不一样</td></tr><tr><td>懒惰型元字符</td><td>*?、+?、{n,}?</td></tr></table>
   1. 一般来说，当在字符集合使用的时候，像星号和加号这样的元字符将被解释为普通字符，不需要被转义，但转义了也没用坏处
   2. 为了增加可读性，也可以把一个字符定义为一个集合。比如http[s]?://和https?是等价的
   3. 贪婪行为会尽可能地从一段文本的开头一直匹配到这段文本的末尾，而不是碰到第一个匹配时为止
   4. 给贪婪型元字符加上一个?就变成懒惰型版本

##  位置匹配
   <table><tr><td>单词边界</td><td>\b来匹配一个单词的开始或结尾</td></tr><tr><td>字符串边界</td><td>字符串开头^和字符串结尾$</td></tr></table>
   1. \b匹配的位置定义：位于一个能够构成单词的字符(\w)和一个不能构成单词的字符(\W)之间
   2. \b匹配且**只匹配一个位置**,不匹配任何字符。是英文boundary边界的首字母
   3. 还有分行匹配模式。比如(?m)^\s*//.*$,匹配代码的每一行注释。

##  子表达式
   1. 把一个表达式划分为一系列子表达式的目的是为了把哪些子表达式当作一个独立元素来使用。
   2. 子表达式必须用(和)括起来。比较一下三种符号：
   <table><tr><td>子表达式</td><td>()小括号</td></tr><tr><td>字符集合</td><td>[]中括号</td></tr><tr><td>重复次数</td><td>{}大括号</td></tr></table>
   3. 子表达式的嵌套,如下匹配**合法的IP地址**
      > ((\d{1,2}) | (1\d{2} | (2[0-4]\d) (25[0-5]))\.){3}((\d{1,2}) | (1\d{2} | (2[0-4]\d) (25[0-5])))
      > 这几个子表达式通过|操作符结合为一个更大的子表达式(匹配四个其中之一即可)。随后的\.与前4个子表达式构成的子表达式又构成了一个更大的子表达式，接下来的{3}表明需要重复3次。最后一个表达式省略了尾部的\.
   4. 分析嵌套子表达式的各个子表达式的时候，应该按照先内后外的原则来进行。

## 回溯引用
   1. 回溯引用指的是模式的后半部分引用在前半部分中定义的子表达式。
   2. 回溯引用只能用来引用模式里的子表达式，即用(和)括起来的正则表达式片段。
   3. 回溯引用匹配通常从1开始计数。在许多实现里，第0个匹配可以用来代表整个正则表达式。
   4. 回溯引用在文本匹配和文本替换操作里非常有用。
   比如：匹配标签和与之配对的标签。
   ><[hH]([1-6])>.*?</[hH]$1>

## 前后查找
   首先标记要匹配的文本的位置，然后对这一位置的前、后内容进行查找。从语法上看，一个向前查找模式其实就是一个以?=开头的子表达式，需要匹配的文本跟在=的后面
   1. 例子1
   >^(?=.*\d).{4,8}$ 
   >匹配长度介于4到8个字符，并且必须至少包含一个数字。对于搜索字符串“abc3qr”，这与“abc3”匹配。

## 嵌入条件
   在正则表达式模式里可以嵌入条件，只有当条件得到（或者没有得到）满足时，相应的表达式才会被执行。



